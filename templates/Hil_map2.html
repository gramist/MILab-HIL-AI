<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>DASHGUM - Bootstrap Admin Template</title>
    <script src="{{url_for('static',filename='chart.min.js')}}"></script>>
    <!-- Bootstrap core CSS -->
    <link href="{{url_for('static',filename='css/bootstrap.css')}}" rel="stylesheet">
    <!--external css-->
    <link href="{{url_for('static',filename='font-awesome/css/font-awesome.css')}}" rel="stylesheet" />
        
    <!-- Custom styles for this templates -->
    <link href="{{url_for('static',filename='css/style.css')}}" rel="stylesheet">
    <link href="{{url_for('static',filename='css/style-responsive.css')}}" rel="stylesheet">

    <link href="{{url_for('static',filename='css/table-responsive.css')}}" rel="stylesheet">
    <style>
      #map-canvas { width: 75%; height: 700px; background-color: #CCC; }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js" type="text/javascript"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">

// 마크, 동선을 그리고 난 후 해당 위치를 array에 저장합니다.
var MarkersArray = [];
var Coordinates= [];
var travelPathArray = [];
var map;

function initialize() {
  var myLatlng = new google.maps.LatLng(33.397, 126.65544);
  var myOptions = {
  zoom: 10,
  center: myLatlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

google.maps.event.addListener(map, 'click', function(event) {
  var marker = new google.maps.Marker({
  position: event.latLng,
  map: map,
  title: '위치마커'
});
attachMessage(marker, event.latLng);
//선을 그리기 위해 좌표를 넣는다.
Coordinates.push( event.latLng );
//마커 담기
MarkersArray.push(marker);
        //array에 담은 위도,경도 데이타를 가지고 동선 그리기
flightPath();
});
}

//해당 위치에 주소를 가져오고, 마크를 클릭시 infowindow에 주소를 표시한다.
function attachMessage(marker, latlng) {
geocoder = new google.maps.Geocoder();
 geocoder.geocode({'latLng': latlng}, function(results, status) {
     if (status == google.maps.GeocoderStatus.OK) {
if (results[0]) {
var address_nm = results[0].formatted_address;
var infowindow = new google.maps.InfoWindow(
     { content: address_nm,
size: new google.maps.Size(50,50)
     });
 google.maps.event.addListener(marker, 'click', function() {
   infowindow.open(map,marker);
 });
}
     } else {
alert('주소 가져오기 오류!');
     }
});
}

//동선그리기
function flightPath(){
for (i in travelPathArray){
travelPathArray[i].setMap(null);
}
var flightPath = new google.maps.Polyline({
path: Coordinates,
strokeColor: "#FF0000",
strokeOpacity: 0.3,
strokeWeight: 2
});
flightPath.setMap(map);
travelPathArray.push(flightPath);
}

</script>
  </head>

  <body>

  <section id="container" >
    <section id="main-content">
      <section class="wrapper">
       	<h3><i class="fa fa-angle-right"></i>지도</h3>
    	  	<div class="row mt">
            <div class="col-lg-12">
              <div class="content-panel">
		  	  <h4><i class="fa fa-angle-right"></i>환자 현 위치</h4>
              <div id="map-canvas">

<!--                <script>-->
<!--         function initMap() {-->
<!--        var map = new google.maps.Map(document.getElementById('map'), {-->
<!--          zoom: 3,-->
<!--          center: {lat: 0, lng: -180},-->
<!--          mapTypeId: 'terrain'-->
<!--        });-->

<!--        var flightPlanCoordinates = [-->
<!--          {lat: 37.772, lng: -122.214},-->
<!--          {lat: 21.291, lng: -157.821},-->
<!--          {lat: -18.142, lng: 178.431},-->
<!--          {lat: -27.467, lng: 153.027}-->
<!--        ];-->
<!--        var flightPath = new google.maps.Polyline({-->
<!--          path: flightPlanCoordinates,-->
<!--          geodesic: true,-->
<!--          strokeColor: '#FF0000',-->
<!--          strokeOpacity: 1.0,-->
<!--          strokeWeight: 2-->
<!--        });-->

<!--        flightPath.setMap(map);-->
<!--      }-->
<!--    </script>-->
<!--                <script async defer-->
<!--src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCkUOdZ5y7hMm0yrcCQoCvLwzdM6M8s5qk&callback=initMap">-->
<!--</script>-->
                </div>
                </div>
              </div>
            </div>
        </section>
    </section><! --/wrapper -->
    </section>
      <!-- 페이징 그리기 -->
      <footer class="site-footer">
          <div class="text-center">
              세종대학교 병원
              <a href="responsive_table.html#" class="go-top">
                  <i class="fa fa-angle-up"></i>
              </a>
          </div>
      </footer>
      <!--footer end-->
  </section>

    <!-- js placed at the end of the document so the pages load faster -->
    <script src="{{url_for('static',filename='js/jquery.js')}}"></script>
    <script src="{{url_for('static',filename='js/bootstrap.min.js')}}"></script>
    <script class="include" type="text/javascript" src="{{url_for('static',filename='js/jquery.dcjqaccordion.2.7.js')}}"></script>
    <script src="{{url_for('static',filename='js/jquery.scrollTo.min.js')}}"></script>
    <script src="{{url_for('static',filename='js/jquery.nicescroll.js')}}" type="text/javascript"></script>


    <!--common script for all pages-->
    <script src="{{url_for('static',filename='js/common-scripts.js')}}"></script>

    <!--script for this page-->
    

  </body>
</html>
